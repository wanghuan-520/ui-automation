# ğŸ“¸ æˆªå›¾å‘½åä¼˜åŒ–è¯´æ˜

## æ¦‚è¿°

ä¼˜åŒ–äº†æµ‹è¯•æˆªå›¾çš„æ–‡ä»¶å‘½åè§„åˆ™ï¼Œè‡ªåŠ¨æ·»åŠ æµ‹è¯•ç”¨ä¾‹åç§°å’Œæ—¶é—´æˆ³ï¼Œä½¿æˆªå›¾æ›´æ˜“äºè¯†åˆ«å’Œç®¡ç†ã€‚

## æ–‡ä»¶å¤¹ç»“æ„ & å‘½åæ ¼å¼

### æ–‡ä»¶å¤¹ç»“æ„
```
test-screenshots/
â”œâ”€â”€ test_aevatar_login/          # ç™»å½•æµ‹è¯•çš„æˆªå›¾
â”‚   â”œâ”€â”€ test_aevatar_login_20251023_152005_01_login_page.png
â”‚   â”œâ”€â”€ test_aevatar_login_20251023_152019_02_form_filled.png
â”‚   â””â”€â”€ test_aevatar_login_20251023_152027_03_login_result.png
â””â”€â”€ test_aevatar_workflow/       # Workflowæµ‹è¯•çš„æˆªå›¾
    â””â”€â”€ test_aevatar_workflow_20251023_152010_01_workflow_page.png
```

### æ–‡ä»¶è·¯å¾„æ ¼å¼
```
test-screenshots/{æµ‹è¯•ç”¨ä¾‹å}/{æµ‹è¯•ç”¨ä¾‹å}_{æ—¶é—´æˆ³}_{æè¿°}.png
```

### ç¤ºä¾‹
```
test-screenshots/test_aevatar_login/test_aevatar_login_20251023_151231_01_login_page.png
test-screenshots/test_aevatar_login/test_aevatar_login_20251023_151245_02_form_filled.png
test-screenshots/test_aevatar_login/test_aevatar_login_20251023_151253_03_login_result.png
test-screenshots/test_aevatar_workflow/test_aevatar_workflow_20251023_152010_01_workflow_page.png
```

## æ–‡ä»¶åç»„æˆ

| éƒ¨åˆ† | è¯´æ˜ | ç¤ºä¾‹ | æ¥æº |
|------|------|------|------|
| æµ‹è¯•ç”¨ä¾‹å | æµ‹è¯•å‡½æ•°å | `test_aevatar_login` | è‡ªåŠ¨è·å– |
| æ—¶é—´æˆ³ | æ‰§è¡Œæ—¶é—´ | `20251023_151231` | è‡ªåŠ¨ç”Ÿæˆ |
| æè¿° | æ­¥éª¤è¯´æ˜ | `01_login_page.png` | æµ‹è¯•ä»£ç æŒ‡å®š |

## ä¼˜åŠ¿å¯¹æ¯”

### ä¼˜åŒ–å‰ âŒ
```
test-screenshots/
â”œâ”€â”€ 01_login_page.png
â”œâ”€â”€ 02_form_filled.png
â”œâ”€â”€ 03_login_result.png
â”œâ”€â”€ 01_workflow_page.png
â”œâ”€â”€ 02_agent_added.png
â””â”€â”€ ... (æ‰€æœ‰æµ‹è¯•çš„æˆªå›¾æ··åœ¨ä¸€èµ·)
```

**é—®é¢˜**ï¼š
- âŒ çœ‹ä¸å‡ºæ˜¯å“ªä¸ªæµ‹è¯•ç”¨ä¾‹
- âŒ å¤šä¸ªæµ‹è¯•ä¼šäº’ç›¸è¦†ç›–
- âŒ æ— æ³•è¿½æº¯æ‰§è¡Œæ—¶é—´
- âŒ éš¾ä»¥åšå†å²å¯¹æ¯”
- âŒ æ ¹ç›®å½•æ–‡ä»¶è¿‡å¤š

### ä¼˜åŒ–å âœ…
```
test-screenshots/
â”œâ”€â”€ test_aevatar_login/          # ç™»å½•æµ‹è¯•ç‹¬ç«‹æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ test_aevatar_login_20251023_151231_01_login_page.png
â”‚   â”œâ”€â”€ test_aevatar_login_20251023_151245_02_form_filled.png
â”‚   â””â”€â”€ test_aevatar_login_20251023_151253_03_login_result.png
â””â”€â”€ test_aevatar_workflow/       # Workflowæµ‹è¯•ç‹¬ç«‹æ–‡ä»¶å¤¹
    â”œâ”€â”€ test_aevatar_workflow_20251023_152010_01_workflow_page.png
    â””â”€â”€ test_aevatar_workflow_20251023_152025_02_agent_added.png
```

**ä¼˜åŠ¿**ï¼š
- âœ… ä¸€çœ¼è¯†åˆ«æµ‹è¯•ç”¨ä¾‹
- âœ… æ—¶é—´æˆ³ä¿è¯å”¯ä¸€æ€§
- âœ… ä¿ç•™åŸæœ‰æè¿°ä¿¡æ¯
- âœ… è‡ªåŠ¨åŒ–å®ç°
- âœ… å‘åå…¼å®¹
- âœ… **æ¯ä¸ªæµ‹è¯•æœ‰ç‹¬ç«‹æ–‡ä»¶å¤¹**
- âœ… **æ–‡ä»¶ç»„ç»‡æ¸…æ™°ï¼Œæ˜“äºç®¡ç†**
- âœ… **å¿«é€Ÿå®šä½ç‰¹å®šæµ‹è¯•çš„æ‰€æœ‰æˆªå›¾**

## æŠ€æœ¯å®ç°

### ä¿®æ”¹çš„æ–‡ä»¶
- `tests/aevatar/base_test.py`

### æ ¸å¿ƒä»£ç 
```python
import inspect
from datetime import datetime

async def take_screenshot(self, filename: str):
    """æˆªå›¾ï¼Œè‡ªåŠ¨æ·»åŠ æµ‹è¯•åç§°å’Œæ—¶é—´æˆ³å‰ç¼€"""
    # è·å–è°ƒç”¨è€…çš„å‡½æ•°åï¼ˆæµ‹è¯•ç”¨ä¾‹åï¼‰
    frame = inspect.currentframe()
    caller_frame = frame.f_back
    test_name = caller_frame.f_code.co_name if caller_frame else "unknown_test"
    
    # ç”Ÿæˆæ—¶é—´æˆ³
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    # ç»„åˆæ–°æ–‡ä»¶å
    new_filename = f"{test_name}_{timestamp}_{filename}"
    
    screenshot_path = os.path.join(self.SCREENSHOT_DIR, new_filename)
    await self.page.screenshot(path=screenshot_path, full_page=True)
    logger.info(f"ğŸ“¸ æˆªå›¾å·²ä¿å­˜: {screenshot_path}")
    return screenshot_path
```

### å…³é”®æŠ€æœ¯
- `inspect.currentframe()` - è·å–è°ƒç”¨æ ˆä¿¡æ¯
- `f_code.co_name` - è·å–å‡½æ•°å
- `datetime.now().strftime()` - ç”Ÿæˆæ—¶é—´æˆ³

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæŸ¥çœ‹ç‰¹å®šæµ‹è¯•çš„æ‰€æœ‰æˆªå›¾
```bash
# æŸ¥çœ‹ç™»å½•æµ‹è¯•çš„æ‰€æœ‰æˆªå›¾
ls test-screenshots/test_aevatar_login/

# æˆ–è¿›å…¥æ–‡ä»¶å¤¹
cd test-screenshots/test_aevatar_login/
ls -lt  # æŒ‰æ—¶é—´æ’åºæŸ¥çœ‹
```

### åœºæ™¯2ï¼šå¯¹æ¯”åŒä¸€æµ‹è¯•çš„å¤šæ¬¡è¿è¡Œ
```bash
# è¿›å…¥æµ‹è¯•æ–‡ä»¶å¤¹
cd test-screenshots/test_aevatar_login/

# æŸ¥çœ‹æ‰€æœ‰å†å²æˆªå›¾
ls -lt

# å¯¹æ¯”ä¸¤æ¬¡è¿è¡Œçš„ç›¸åŒæ­¥éª¤
diff <first_run>_01_login_page.png <second_run>_01_login_page.png
```

### åœºæ™¯3ï¼šå¿«é€Ÿæ¸…ç†ç‰¹å®šæµ‹è¯•çš„æˆªå›¾
```bash
# åªåˆ é™¤ç™»å½•æµ‹è¯•çš„æˆªå›¾
rm -rf test-screenshots/test_aevatar_login/

# å…¶ä»–æµ‹è¯•çš„æˆªå›¾ä¸å—å½±å“
```

### åœºæ™¯4ï¼šæ‰“åŒ…ç‰¹å®šæµ‹è¯•çš„æˆªå›¾
```bash
# å°†ç™»å½•æµ‹è¯•çš„æ‰€æœ‰æˆªå›¾æ‰“åŒ…
zip -r login_screenshots.zip test-screenshots/test_aevatar_login/
```

### åœºæ™¯5ï¼šå¤±è´¥åˆ†æ
å¤±è´¥æˆªå›¾è‡ªåŠ¨åŒ…å«æµ‹è¯•åå’Œæ—¶é—´ï¼Œä¸”ä¿å­˜åœ¨ç‹¬ç«‹æ–‡ä»¶å¤¹ä¸­ï¼Œæ–¹ä¾¿è¿½æº¯å’Œåˆ†äº«

## æœ€ä½³å®è·µ

### 1. æè¿°æ€§åŸå§‹æ–‡ä»¶å
ç»§ç»­ä½¿ç”¨æœ‰æ„ä¹‰çš„æè¿°ï¼š
```python
await test_instance.take_screenshot("01_login_page.png")
await test_instance.take_screenshot("02_form_filled.png")
await test_instance.take_screenshot("03_login_result.png")
```

### 2. æŒ‰æ­¥éª¤ç¼–å·
ä½¿ç”¨åºå·ï¼ˆ01ã€02ã€03...ï¼‰è¡¨ç¤ºæµ‹è¯•æ­¥éª¤é¡ºåº

### 3. ç®€æ´æ˜äº†
åŸå§‹æè¿°ä¿æŒç®€çŸ­ï¼Œå…³é”®ä¿¡æ¯å·²åœ¨æµ‹è¯•åä¸­

### 4. ç»Ÿä¸€æ ¼å¼
æ‰€æœ‰æµ‹è¯•ä½¿ç”¨ç›¸åŒçš„å‘½åè§„èŒƒ

## ä½¿ç”¨æŠ€å·§

### æ–‡ä»¶å¤¹ç®¡ç†
```bash
# æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•çš„æˆªå›¾æ–‡ä»¶å¤¹
ls -d test-screenshots/*/

# æŸ¥çœ‹æ¯ä¸ªæµ‹è¯•çš„æˆªå›¾æ•°é‡
for dir in test-screenshots/*/; do 
  echo "$dir: $(ls -1 $dir | wc -l) å¼ æˆªå›¾"
done

# æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•çš„æ€»ç£ç›˜å ç”¨
du -sh test-screenshots/*/
```

### å¿«é€ŸæŸ¥æ‰¾
```bash
# æŸ¥çœ‹ç‰¹å®šæµ‹è¯•çš„æ‰€æœ‰æˆªå›¾
ls test-screenshots/test_aevatar_login/

# æŸ¥çœ‹æœ€æ–°çš„æˆªå›¾
find test-screenshots/ -name "*.png" -type f -mtime -1

# æŒ‰æ—¥æœŸæŸ¥æ‰¾ï¼ˆæŸ¥æ‰¾ä»Šå¤©çš„ï¼‰
find test-screenshots/ -name "*20251023_*"
```

### æ¸…ç†æ—§æˆªå›¾
```bash
# åˆ é™¤7å¤©å‰çš„æˆªå›¾ï¼ˆæŒ‰æ–‡ä»¶å¤¹ï¼‰
find test-screenshots/* -type d -mtime +7 -exec rm -rf {} \;

# æˆ–è€…æ‰‹åŠ¨åˆ é™¤ç‰¹å®šæµ‹è¯•çš„æ—§æˆªå›¾
rm -rf test-screenshots/test_aevatar_login/
```

## å…¼å®¹æ€§

### âœ… å‘åå…¼å®¹
- æ‰€æœ‰ç°æœ‰æµ‹è¯•æ–‡ä»¶æ— éœ€ä¿®æ”¹
- è‡ªåŠ¨åº”ç”¨äºæ‰€æœ‰è°ƒç”¨ `take_screenshot()` çš„æµ‹è¯•
- ä¸å½±å“æµ‹è¯•é€»è¾‘

### âœ… è‡ªåŠ¨ç”Ÿæ•ˆçš„æ–‡ä»¶
- `test_daily_regression_login.py`
- `test_daily_regression_workflow.py`
- `test_daily_regression_complete.py`
- `test_daily_regression_dashboard.py`
- `test_daily_regression_organisation.py`
- `test_daily_regression_project.py`
- æ‰€æœ‰å…¶ä»–ä½¿ç”¨ `base_test.py` çš„æµ‹è¯•

## éªŒè¯æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
pytest tests/aevatar/test_daily_regression_login.py -v
```

### ç”Ÿæˆçš„æˆªå›¾
```
âœ… test_aevatar_login_20251023_151231_01_login_page.png
âœ… test_aevatar_login_20251023_151245_02_form_filled.png
âœ… test_aevatar_login_20251023_151253_03_login_result.png
```

## æ—¶é—´æˆ³æ ¼å¼

### æ ¼å¼è¯´æ˜
- `YYYYMMDD_HHMMSS`
- ä¾‹å¦‚ï¼š`20251023_151231` = 2025å¹´10æœˆ23æ—¥ 15:12:31

### ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡
- âœ… æ–‡ä»¶åå‹å¥½ï¼ˆæ— ç‰¹æ®Šå­—ç¬¦ï¼‰
- âœ… æŒ‰å­—æ¯æ’åºå³æŒ‰æ—¶é—´æ’åº
- âœ… ç´§å‡‘ä¸”æ˜“è¯»
- âœ… è·¨å¹³å°å…¼å®¹

## å¸¸è§é—®é¢˜

### Q: ä¼šä¸ä¼šå¤ªé•¿ï¼Ÿ
A: è™½ç„¶æ–‡ä»¶åè¾ƒé•¿ï¼Œä½†ä¿¡æ¯å®Œæ•´ï¼Œç°ä»£æ–‡ä»¶ç³»ç»Ÿæ”¯æŒé•¿æ–‡ä»¶åã€‚

### Q: å¦‚æœä¸æƒ³è¦æ—¶é—´æˆ³ï¼Ÿ
A: å¯ä»¥ä¿®æ”¹ `base_test.py` çš„ `take_screenshot` æ–¹æ³•ï¼Œç§»é™¤æ—¶é—´æˆ³éƒ¨åˆ†ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰æ ¼å¼ï¼Ÿ
A: ä¿®æ”¹ `base_test.py` ä¸­çš„ `timestamp` æ ¼å¼å­—ç¬¦ä¸²ã€‚

### Q: æµ‹è¯•åå¤ªé•¿æ€ä¹ˆåŠï¼Ÿ
A: å»ºè®®ä½¿ç”¨ç®€æ´çš„æµ‹è¯•å‡½æ•°åï¼Œå¦‚ `test_login` è€Œä¸æ˜¯ `test_user_login_with_email_and_password`ã€‚

## å…³é”®æ”¹è¿›ç‚¹

- âœ… **è‡ªåŠ¨åŒ–** - æ— éœ€æ‰‹åŠ¨å‘½åï¼Œæ–‡ä»¶å¤¹è‡ªåŠ¨åˆ›å»º
- âœ… **æ ‡å‡†åŒ–** - ç»Ÿä¸€çš„å‘½åæ ¼å¼
- âœ… **å¯è¿½æº¯** - åŒ…å«æ—¶é—´æˆ³
- âœ… **æ˜“è¯†åˆ«** - æµ‹è¯•åç§°æ¸…æ™°
- âœ… **ä¸è¦†ç›–** - æ¯æ¬¡è¿è¡Œç‹¬ç«‹ä¿å­˜
- âœ… **ç‹¬ç«‹ç®¡ç†** - æ¯ä¸ªæµ‹è¯•æœ‰è‡ªå·±çš„æ–‡ä»¶å¤¹
- âœ… **æ¸…æ™°ç»„ç»‡** - æ–‡ä»¶å±‚æ¬¡ç»“æ„æ¸…æ™°
- âœ… **æ˜“äºæŸ¥æ‰¾** - å¿«é€Ÿå®šä½ç‰¹å®šæµ‹è¯•çš„æˆªå›¾

## æœªæ¥æ‰©å±•

### å¯èƒ½çš„å¢å¼º
1. æ·»åŠ å¤±è´¥/æˆåŠŸæ ‡è®°
2. æ·»åŠ æµè§ˆå™¨ç±»å‹æ ‡è®°
3. æ·»åŠ åˆ†è¾¨ç‡æ ‡è®°
4. æ”¯æŒè‡ªå®šä¹‰å‰ç¼€

### ç¤ºä¾‹æ‰©å±•æ ¼å¼
```
test_aevatar_login_20251023_151231_chrome_1920x1080_success_01_login_page.png
```

---

**åˆ›å»ºæ—¶é—´**: 2025-10-23  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å·²å®æ–½å¹¶éªŒè¯

