# Allure æŠ¥å‘Šæ•…éšœæ’é™¤æŒ‡å—

## âŒ é—®é¢˜ï¼šæŠ¥å‘Šä¸€ç›´æ˜¾ç¤º Loading

### ğŸ” é—®é¢˜åŸå› 

å½“ä½ ç›´æ¥é€šè¿‡ `file://` åè®®æ‰“å¼€ `allure-report/index.html` æ—¶ï¼Œä¼šé‡åˆ°**è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰**é™åˆ¶ï¼š

```
âŒ é”™è¯¯æ–¹å¼: file:///path/to/allure-report/index.html
   â†’ æµè§ˆå™¨ä¼šé˜»æ­¢åŠ è½½æ•°æ®æ–‡ä»¶
   â†’ é¡µé¢ä¸€ç›´æ˜¾ç¤º Loading åŠ¨ç”»
```

è¿™æ˜¯å› ä¸ºç°ä»£æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ä¸å…è®¸æœ¬åœ°HTMLæ–‡ä»¶åŠ è½½å…¶ä»–æœ¬åœ°JSONæ–‡ä»¶ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰â­â­â­â­â­

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
./start_allure_server.sh
```

**ç‰¹ç‚¹**ï¼š
- âœ… è‡ªåŠ¨æ£€æŸ¥ç«¯å£å ç”¨
- âœ… è‡ªåŠ¨å¯åŠ¨HTTPæœåŠ¡å™¨
- âœ… è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
- âœ… å›ºå®šç«¯å£ 8888
- âœ… ä¸€é”®æå®š

### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ allure serve å‘½ä»¤ â­â­â­â­

```bash
cd /Users/wanghuan/aelf/Cursor/ui-automation
allure serve allure-results
```

**ç‰¹ç‚¹**ï¼š
- âœ… è‡ªåŠ¨ç”Ÿæˆå¹¶å¯åŠ¨æœåŠ¡
- âœ… è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
- âš ï¸ ç«¯å£éšæœºåˆ†é…
- âš ï¸ æ¯æ¬¡éƒ½é‡æ–°ç”ŸæˆæŠ¥å‘Šï¼ˆè¾ƒæ…¢ï¼‰

### æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ allure open å‘½ä»¤ â­â­â­

```bash
cd /Users/wanghuan/aelf/Cursor/ui-automation
allure open allure-report
```

**ç‰¹ç‚¹**ï¼š
- âœ… ä½¿ç”¨å·²ç”Ÿæˆçš„æŠ¥å‘Šï¼ˆå¿«é€Ÿï¼‰
- âœ… è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
- âš ï¸ ç«¯å£éšæœºåˆ†é…

### æ–¹æ¡ˆå››ï¼šæŒ‡å®šç«¯å£å¯åŠ¨ â­â­â­â­

```bash
# æŒ‡å®šç«¯å£ 8888
allure serve allure-results -p 8888

# æˆ–è€…
allure open allure-report -p 8888
```

**ç‰¹ç‚¹**ï¼š
- âœ… å›ºå®šç«¯å£ï¼Œä¾¿äºè®¿é—®
- âœ… å¯ä»¥ä¿å­˜ä¹¦ç­¾
- âœ… é€‚åˆæŒç»­è®¿é—®

### æ–¹æ¡ˆäº”ï¼šä½¿ç”¨ Python HTTP æœåŠ¡å™¨ â­â­

```bash
cd allure-report
python3 -m http.server 8888
```

ç„¶åè®¿é—®: http://localhost:8888

**ç‰¹ç‚¹**ï¼š
- âœ… ç®€å•ç›´æ¥
- âš ï¸ éœ€è¦æ‰‹åŠ¨æ‰“å¼€æµè§ˆå™¨
- âš ï¸ ä¸ä¼šè‡ªåŠ¨åˆ·æ–°æ•°æ®

---

## ğŸ¯ æ¨èä½¿ç”¨æµç¨‹

### é¦–æ¬¡æŸ¥çœ‹æŠ¥å‘Š

```bash
# 1. è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆæ•°æ®
python3 -m pytest tests/aevatar/test_daily_regression_project.py \
  -m project --alluredir=allure-results --clean-alluredir

# 2. å¯åŠ¨æœåŠ¡æŸ¥çœ‹æŠ¥å‘Š
./start_allure_server.sh
```

### å†æ¬¡æŸ¥çœ‹æŠ¥å‘Š

```bash
# ç›´æ¥å¯åŠ¨ï¼ˆä½¿ç”¨å·²æœ‰æ•°æ®ï¼‰
./start_allure_server.sh
```

### æ›´æ–°æŠ¥å‘Š

```bash
# 1. é‡æ–°è¿è¡Œæµ‹è¯•
python3 -m pytest tests/aevatar/test_daily_regression_project.py \
  -m project --alluredir=allure-results

# 2. é‡å¯æœåŠ¡ï¼ˆä¼šè‡ªåŠ¨é‡æ–°ç”Ÿæˆï¼‰
./start_allure_server.sh
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: ç«¯å£ 8888 å·²è¢«å ç”¨æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ³•1**: åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹

```bash
# æŸ¥æ‰¾å ç”¨ 8888 ç«¯å£çš„è¿›ç¨‹
lsof -i :8888

# åœæ­¢è¿›ç¨‹ï¼ˆæ›¿æ¢ PIDï¼‰
kill -9 <PID>
```

**è§£å†³æ–¹æ³•2**: ä½¿ç”¨å…¶ä»–ç«¯å£

```bash
allure serve allure-results -p 9999
```

### Q2: æµè§ˆå™¨æ²¡æœ‰è‡ªåŠ¨æ‰“å¼€ï¼Ÿ

**æ‰‹åŠ¨æ‰“å¼€æµè§ˆå™¨è®¿é—®**:
```
http://localhost:8888
```

### Q3: æ˜¾ç¤º"No results"ï¼Ÿ

**åŸå› **: `allure-results` ç›®å½•ä¸ºç©ºæˆ–ä¸å­˜åœ¨

**è§£å†³**: å…ˆè¿è¡Œæµ‹è¯•ç”Ÿæˆæ•°æ®
```bash
python3 -m pytest tests/aevatar/test_daily_regression_project.py \
  -m project --alluredir=allure-results
```

### Q4: æŠ¥å‘Šæ•°æ®ä¸æ˜¯æœ€æ–°çš„ï¼Ÿ

**åŸå› **: æµè§ˆå™¨ç¼“å­˜

**è§£å†³**: å¼ºåˆ¶åˆ·æ–°é¡µé¢
- Mac: `Cmd + Shift + R`
- Windows/Linux: `Ctrl + Shift + R`

æˆ–æ¸…ç†åé‡æ–°ç”Ÿæˆï¼š
```bash
rm -rf allure-results allure-report
# é‡æ–°è¿è¡Œæµ‹è¯•...
```

### Q5: å¦‚ä½•åœæ­¢ Allure æœåŠ¡å™¨ï¼Ÿ

**æ–¹æ³•1**: åœ¨ç»ˆç«¯æŒ‰ `Ctrl + C`

**æ–¹æ³•2**: åœæ­¢æ‰€æœ‰ Allure è¿›ç¨‹
```bash
pkill -f "allure.*serve"
```

---

## ğŸ“š æŠ€æœ¯åŸç†

### ä¸ºä»€ä¹ˆéœ€è¦ HTTP æœåŠ¡å™¨ï¼Ÿ

Allure æŠ¥å‘Šçš„å·¥ä½œåŸç†ï¼š

```
index.html
    â†“ (åŠ è½½)
data/*.json  â† æµè§ˆå™¨å®‰å…¨ç­–ç•¥é˜»æ­¢ file:// åè®®åŠ è½½
```

é€šè¿‡HTTPæœåŠ¡å™¨ï¼š

```
http://localhost:8888/index.html
    â†“ (HTTPè¯·æ±‚)
http://localhost:8888/data/*.json  â† âœ… å…è®¸
```

### CORS æ˜¯ä»€ä¹ˆï¼Ÿ

**CORS (Cross-Origin Resource Sharing)** - è·¨åŸŸèµ„æºå…±äº«

æµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶ï¼Œé˜²æ­¢æ¶æ„ç½‘ç«™è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚

**file:// åè®®çš„é™åˆ¶**:
- âŒ æ— æ³•åŠ è½½åŒç›®å½•ä¸‹çš„å…¶ä»–æ–‡ä»¶
- âŒ æ— æ³•æ‰§è¡Œ AJAX è¯·æ±‚
- âŒ æ— æ³•ä½¿ç”¨ Web Workers

**http:// åè®®**:
- âœ… å¯ä»¥åŠ è½½åŒæºèµ„æº
- âœ… å¯ä»¥æ‰§è¡Œ AJAX
- âœ… å®Œæ•´çš„ Web åŠŸèƒ½

---

## ğŸ¨ æœ€ä½³å®è·µ

### 1. å¼€å‘é˜¶æ®µ

ä½¿ç”¨ `allure serve`ï¼Œæ¯æ¬¡æµ‹è¯•åè‡ªåŠ¨æŸ¥çœ‹æœ€æ–°ç»“æœï¼š

```bash
# ä¸€é”®æµ‹è¯•å¹¶æŸ¥çœ‹
python3 -m pytest ... --alluredir=allure-results && \
  allure serve allure-results
```

### 2. CI/CD é›†æˆ

ç”Ÿæˆé™æ€æŠ¥å‘Šï¼Œéƒ¨ç½²åˆ° Web æœåŠ¡å™¨ï¼š

```bash
# ç”ŸæˆæŠ¥å‘Š
allure generate allure-results -o allure-report --clean

# éƒ¨ç½²åˆ° Web æœåŠ¡å™¨
# ä¾‹å¦‚ï¼šrsync, scp, æˆ– CI å·¥å…·çš„ artifact åŠŸèƒ½
```

### 3. å›¢é˜Ÿå…±äº«

éƒ¨ç½²åˆ°å†…ç½‘æœåŠ¡å™¨ï¼Œå›¢é˜Ÿæˆå‘˜å¯ä»¥ç›´æ¥è®¿é—®ï¼š

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /var/www/test-reports
allure generate allure-results -o project-tests
# é€šè¿‡ http://test-reports.company.com/project-tests è®¿é—®
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°

æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹ Console æ ‡ç­¾é¡µï¼š

**æ­£å¸¸æƒ…å†µ**:
```
âœ… æ²¡æœ‰çº¢è‰²é”™è¯¯
âœ… æˆåŠŸåŠ è½½ data/*.json
```

**å¼‚å¸¸æƒ…å†µ**:
```
âŒ CORS policy error
âŒ Failed to load resource
âŒ net::ERR_FILE_NOT_FOUND
```

### æ£€æŸ¥ç½‘ç»œè¯·æ±‚

åœ¨ Network æ ‡ç­¾é¡µä¸­ï¼š

**æ­£å¸¸æƒ…å†µ**:
```
âœ… æ‰€æœ‰ .json æ–‡ä»¶çŠ¶æ€ç  200
âœ… Content-Type: application/json
```

**å¼‚å¸¸æƒ…å†µ**:
```
âŒ çŠ¶æ€ç  0 (CORS blocked)
âŒ çŠ¶æ€ç  404 (æ–‡ä»¶ä¸å­˜åœ¨)
```

---

## ğŸ“– å‚è€ƒèµ„æº

- [Allure å®˜æ–¹æ–‡æ¡£](https://docs.qameta.io/allure/)
- [CORS è§£é‡Š](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)
- [æœ¬åœ° HTTP æœåŠ¡å™¨å¯¹æ¯”](https://gist.github.com/willurd/5720255)

---

## âœ… å¿«é€Ÿæ£€æŸ¥æ¸…å•

åœ¨æŠ¥å‘Šæ— æ³•åŠ è½½æ—¶ï¼ŒæŒ‰é¡ºåºæ£€æŸ¥ï¼š

- [ ] æ˜¯å¦é€šè¿‡ HTTP æœåŠ¡å™¨è®¿é—®ï¼Ÿï¼ˆURLä»¥ `http://` å¼€å¤´ï¼‰
- [ ] `allure-results` ç›®å½•æ˜¯å¦å­˜åœ¨ä¸”æœ‰æ•°æ®ï¼Ÿ
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ CORS é”™è¯¯ï¼Ÿ
- [ ] Allure æœåŠ¡å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Ÿ
- [ ] ç«¯å£æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨ï¼Ÿ
- [ ] æµè§ˆå™¨ç¼“å­˜æ˜¯å¦éœ€è¦æ¸…ç†ï¼Ÿ

---

**æœ€åæ›´æ–°**: 2025-10-28  
**é—®é¢˜çŠ¶æ€**: âœ… å·²è§£å†³  

---

## ğŸŠ ç°åœ¨ä½ åº”è¯¥èƒ½æ­£å¸¸æŸ¥çœ‹æŠ¥å‘Šäº†ï¼

è®¿é—®: **http://localhost:8888**

æˆ–è¿è¡Œ: **./start_allure_server.sh**

