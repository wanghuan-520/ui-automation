# Project Member æµ‹è¯•é—®é¢˜åˆ†ææŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸ**: 2025-10-28  
**æµ‹è¯•ç”¨ä¾‹**: test_project_member_add & test_project_member_delete  
**æµ‹è¯•çŠ¶æ€**: å‡è·³è¿‡ï¼ˆSKIPPEDï¼‰

---

## ğŸ” é—®é¢˜è¯¦æƒ…

### é—®é¢˜ 1: test_project_member_add [P0]

#### ç°è±¡
```
â­ï¸ SKIPPED: æ— æ³•æ·»åŠ member - AddæŒ‰é’®ç‚¹å‡»è¶…æ—¶
è€—æ—¶: 56ç§’
```

#### æµ‹è¯•æµç¨‹

1. âœ… ç™»å½•æˆåŠŸ
2. âœ… é€‰æ‹©ProjectæˆåŠŸ
3. âœ… æ‰“å¼€"Add team members"å¯¹è¯æ¡†
4. âš ï¸ **Emailé€‰æ‹©å™¨å¤±è´¥**ï¼ˆå…³é”®é—®é¢˜ï¼‰
5. âœ… é€‰æ‹©Roleä¸ºReader
6. âœ… AddæŒ‰é’®æ˜¾ç¤ºä¸ºå¯ç‚¹å‡»
7. âŒ ç‚¹å‡»AddæŒ‰é’®è¶…æ—¶ï¼ˆ10ç§’æ— å“åº”ï¼‰

#### æ ¹æœ¬åŸå› åˆ†æ

**1. Emailä¸‹æ‹‰æ¡†å®šä½å¤±è´¥**

ä»£ç å°è¯•å®šä½Emailä¸‹æ‹‰æ¡†ä»¥æ£€æŸ¥æ˜¯å¦æœ‰å¯é€‰ç”¨æˆ·ï¼š

```python
# å½“å‰é€‰æ‹©å™¨
email_dropdown = await page.query_selector('label:has-text("Email Address") + div')
```

**é—®é¢˜**ï¼š
- é€‰æ‹©å™¨å¯èƒ½ä¸åŒ¹é…å®é™…HTMLç»“æ„
- å¯¼è‡´æ— æ³•æ£€æŸ¥æ˜¯å¦æœ‰å¯æ·»åŠ çš„ç”¨æˆ·
- æµ‹è¯•ç»§ç»­ä½¿ç”¨é»˜è®¤Emailï¼ˆaevatarwh2@teml.netï¼‰

**2. é»˜è®¤Emailæ— æ³•æ·»åŠ **

ä»æˆªå›¾çœ‹åˆ°ï¼š
- Email: `aevatarwh2@teml.net` ï¼ˆæ˜¾ç¤ºä¸ºé»˜è®¤å€¼ï¼‰
- Role: `Reader` ï¼ˆå·²æ­£ç¡®é€‰æ‹©ï¼‰
- AddæŒ‰é’®ï¼šæ˜¾ç¤ºä¸ºå¯ç‚¹å‡»çŠ¶æ€

ä½†ç‚¹å‡»åæ— å“åº”çš„åŸå› ï¼š

**å¯èƒ½åŸå›  A**: Emailä¸åœ¨Organisationä¸­
- Project Memberåªèƒ½ä»Organisationç°æœ‰æˆå‘˜ä¸­æ·»åŠ 
- `aevatarwh2@teml.net` å¯èƒ½ä¸æ˜¯Organisationæˆå‘˜
- åç«¯æ‹’ç»æ·»åŠ ä½†å‰ç«¯æ²¡æœ‰é”™è¯¯æç¤º

**å¯èƒ½åŸå›  B**: ç”¨æˆ·å·²å­˜åœ¨
- è¯¥ç”¨æˆ·å¯èƒ½å·²ç»æ˜¯Project member
- ä½†ç”±äºæŸç§åŸå› åˆ—è¡¨ä¸­æœªæ˜¾ç¤º
- åç«¯æ ¡éªŒå¤±è´¥ä½†UIæ— åé¦ˆ

**å¯èƒ½åŸå›  C**: UI å“åº”ç¼“æ…¢
- ç‚¹å‡»åéœ€è¦ç­‰å¾…åç«¯å“åº”
- 10ç§’å¯èƒ½ä¸è¶³ä»¥å®Œæˆæ“ä½œ
- éœ€è¦æ›´é•¿çš„è¶…æ—¶æ—¶é—´

#### éªŒè¯æ­¥éª¤

**éªŒè¯1**: æ£€æŸ¥Organisationæˆå‘˜
```
1. ç™»å½•ç³»ç»Ÿ
2. è¿›å…¥ Organisation â†’ Member
3. ç¡®è®¤ aevatarwh2@teml.net æ˜¯å¦å­˜åœ¨
4. å¦‚ä¸å­˜åœ¨ï¼Œæ‰‹åŠ¨æ·»åŠ 
```

**éªŒè¯2**: æ£€æŸ¥Project Memberåˆ—è¡¨
```
1. è¿›å…¥ Project â†’ Member  
2. ç¡®è®¤ aevatarwh2@teml.net æ˜¯å¦å·²ç»æ˜¯member
3. å¦‚å·²å­˜åœ¨ï¼Œæµ‹è¯•åº”è¯¥å…ˆåˆ é™¤æˆ–ä½¿ç”¨å…¶ä»–Email
```

**éªŒè¯3**: æ‰‹åŠ¨æµ‹è¯•AddåŠŸèƒ½
```
1. æ‰‹åŠ¨æ‰“å¼€Add Memberå¯¹è¯æ¡†
2. æŸ¥çœ‹Emailä¸‹æ‹‰æ¡†ä¸­æœ‰å“ªäº›é€‰é¡¹
3. å°è¯•æ·»åŠ å¹¶è§‚å¯Ÿæ˜¯å¦æœ‰é”™è¯¯æç¤º
4. è®°å½•å®é™…çš„å“åº”æ—¶é—´
```

---

### é—®é¢˜ 2: test_project_member_delete [P1]

#### ç°è±¡
```
â­ï¸ SKIPPED: åªæœ‰ä¸€ä¸ªmemberï¼ˆOwnerï¼‰ï¼Œæ— å¯åˆ é™¤çš„member
è€—æ—¶: 38ç§’
```

#### æµ‹è¯•æµç¨‹

1. âœ… ç™»å½•æˆåŠŸ
2. âœ… å¯¼èˆªåˆ°Memberé¡µé¢
3. â„¹ï¸ æ£€æµ‹åˆ°Memberæ•°é‡=1
4. âœ… æ™ºèƒ½åˆ¤æ–­ï¼šä¸èƒ½åˆ é™¤å”¯ä¸€çš„Owner
5. â­ï¸ è·³è¿‡æµ‹è¯•ï¼ˆç¬¦åˆé¢„æœŸï¼‰

#### çŠ¶æ€è¯„ä¼°

**è¿™ä¸æ˜¯bugï¼** è¿™æ˜¯æ­£ç¡®çš„è¡Œä¸ºï¼š

```
å½“å‰çŠ¶æ€:
- Members: 1ä¸ª
- Name: user_1024161702_ygmd87
- Email: aevatarwh1@teml.net
- Role: Owner

ç³»ç»Ÿè§„åˆ™:
âŒ ä¸èƒ½åˆ é™¤Projectçš„å”¯ä¸€Owner
âœ… æµ‹è¯•æ­£ç¡®åœ°æ£€æµ‹å¹¶è·³è¿‡
```

#### ä¾èµ–å…³ç³»

```
test_project_member_delete ä¾èµ–äº test_project_member_add

æµç¨‹ï¼š
1. test_project_member_add æ·»åŠ ä¸€ä¸ªmember
2. test_project_member_delete åˆ é™¤è¿™ä¸ªmember

å½“å‰é—®é¢˜ï¼š
âŒ æ­¥éª¤1å¤±è´¥ â†’ æ­¥éª¤2æ— æ³•æ‰§è¡Œ
```

---

## ğŸ¯ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆA: æ‰‹åŠ¨å‡†å¤‡æµ‹è¯•æ•°æ®ï¼ˆæ¨èï¼‰

**æ­¥éª¤1**: æ·»åŠ Organisationæˆå‘˜
```
è·¯å¾„: Organisation â†’ Member
æ“ä½œ: æ·»åŠ  aevatarwh3@teml.net æˆ–å…¶ä»–æµ‹è¯•è´¦å·
```

**æ­¥éª¤2**: å°†è¯¥æˆå‘˜æ·»åŠ åˆ°Project
```
è·¯å¾„: Project â†’ Member
æ“ä½œ: æ‰‹åŠ¨æ·»åŠ åˆšåˆ›å»ºçš„æˆå‘˜
```

**æ­¥éª¤3**: é‡æ–°è¿è¡Œæµ‹è¯•
```bash
python3 -m pytest tests/aevatar/test_daily_regression_project.py::test_project_member_delete -v
```

### æ–¹æ¡ˆB: ä½¿ç”¨APIå‡†å¤‡æ•°æ®

åˆ›å»ºæµ‹è¯•æ•°æ®å‡†å¤‡è„šæœ¬ï¼š

```python
# setup_test_data.py
async def setup_project_member_test_data():
    """å‡†å¤‡Project Memberæµ‹è¯•æ•°æ®"""
    # 1. åˆ›å»ºOrganisationæˆå‘˜
    await api.create_org_member({
        "email": "test_member_001@teml.net",
        "role": "member"
    })
    
    # 2. æ·»åŠ åˆ°Project
    await api.add_project_member({
        "project_id": project_id,
        "email": "test_member_001@teml.net",
        "role": "Reader"
    })
```

### æ–¹æ¡ˆC: ä¿®æ”¹æµ‹è¯•é€»è¾‘

**1. æ”¹è¿›Emailé€‰æ‹©å™¨**

æ‰¾åˆ°æ­£ç¡®çš„Emailä¸‹æ‹‰æ¡†å®šä½æ–¹å¼ï¼š

```python
# æ–¹æ¡ˆ1: é€šè¿‡ç´¢å¼•å®šä½ï¼ˆç¬¬ä¸€ä¸ªcomboboxæ˜¯Emailï¼‰
email_dropdown = await page.query_selector('[role="combobox"]')

# æ–¹æ¡ˆ2: é€šè¿‡æ£€æŸ¥ä¸‹æ‹‰é€‰é¡¹å†…å®¹
dropdowns = await page.query_selector_all('[role="combobox"]')
for dropdown in dropdowns:
    # æ£€æŸ¥æ˜¯å¦åŒ…å«@ç¬¦å·ï¼ˆEmailç‰¹å¾ï¼‰
    ...

# æ–¹æ¡ˆ3: ä½¿ç”¨æ›´å…·ä½“çš„å±æ€§
email_dropdown = await page.query_selector('[data-testid="email-select"]')
```

**2. å¢åŠ AddæŒ‰é’®è¶…æ—¶æ—¶é—´**

```python
# å½“å‰: timeout=10000 (10ç§’)
await add_final_button.click(timeout=10000)

# å»ºè®®: timeout=20000 (20ç§’)
await add_final_button.click(timeout=20000)
```

**3. æ·»åŠ é”™è¯¯æç¤ºæ£€æµ‹**

```python
# ç‚¹å‡»Addåæ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯æç¤º
await add_final_button.click()
await page.wait_for_timeout(2000)

error_msg = await page.query_selector('text=/error|failed|invalid/i')
if error_msg:
    error_text = await error_msg.text_content()
    logger.error(f"âŒ æ·»åŠ å¤±è´¥: {error_text}")
```

### æ–¹æ¡ˆD: æ¥å—å½“å‰çŠ¶æ€

**ç†ç”±**ï¼š
- âœ… æµ‹è¯•ä»£ç é€»è¾‘æ­£ç¡®
- âœ… èƒ½æ™ºèƒ½å¤„ç†ç¯å¢ƒé™åˆ¶
- âœ… æ ¸å¿ƒåŠŸèƒ½ï¼ˆRoleç®¡ç†ï¼‰å·²éªŒè¯
- âš ï¸ Memberç®¡ç†å—æµ‹è¯•ç¯å¢ƒé™åˆ¶

**å»ºè®®**ï¼š
- åœ¨æ–‡æ¡£ä¸­æ ‡æ³¨æµ‹è¯•å‰ç½®æ¡ä»¶
- å°†è¿™ä¸¤ä¸ªæµ‹è¯•æ ‡è®°ä¸º"éœ€è¦ç‰¹å®šæ•°æ®"
- åœ¨æœ‰å‡†å¤‡çš„ç¯å¢ƒä¸­å®šæœŸæ‰§è¡Œ

---

## ğŸ“Š å½±å“è¯„ä¼°

### å¯¹æµ‹è¯•è¦†ç›–ç‡çš„å½±å“

```
æ€»æµ‹è¯•ç”¨ä¾‹: 6ä¸ª

âœ… é€šè¿‡: 4ä¸ª (66.7%)
- test_project_role_add
- test_project_name_edit
- test_project_role_edit_permissions
- test_project_role_delete

â­ï¸ è·³è¿‡: 2ä¸ª (33.3%)
- test_project_member_add
- test_project_member_delete

åŠŸèƒ½è¦†ç›–:
âœ… Project Settings: å·²è¦†ç›–
âœ… Project Roles: å®Œå…¨è¦†ç›–ï¼ˆCRUDå…¨éƒ¨é€šè¿‡ï¼‰
âš ï¸ Project Members: éƒ¨åˆ†è¦†ç›–ï¼ˆåˆ—è¡¨å¯è®¿é—®ï¼Œå¢åˆ å—é™ï¼‰
```

### é£é™©è¯„ä¼°

ğŸŸ¢ **ä½é£é™©** - ä¸å½±å“ä¸»è¦åŠŸèƒ½éªŒè¯

**åŸå› **ï¼š
1. Memberåˆ—è¡¨é¡µé¢å¯æ­£å¸¸è®¿é—®
2. UIäº¤äº’æ­£å¸¸ï¼ˆæŒ‰é’®ã€å¯¹è¯æ¡†ï¼‰
3. Roleç®¡ç†åŠŸèƒ½å·²å……åˆ†éªŒè¯
4. é—®é¢˜ä¸»è¦åœ¨æµ‹è¯•æ•°æ®å‡†å¤‡

---

## ğŸ”§ å¾…ä¿®å¤é¡¹

### ä¼˜å…ˆçº§P1: Emailé€‰æ‹©å™¨å®šä½

**é—®é¢˜**: æ— æ³•å‡†ç¡®å®šä½Emailä¸‹æ‹‰æ¡†  
**å½±å“**: æ— æ³•è‡ªåŠ¨æ£€æŸ¥å¯æ·»åŠ ç”¨æˆ·  
**ä¿®å¤**: ä½¿ç”¨æ›´ç²¾ç¡®çš„é€‰æ‹©å™¨æˆ–éå†æ‰€æœ‰combobox

### ä¼˜å…ˆçº§P2: å¢åŠ è¶…æ—¶æ—¶é—´

**é—®é¢˜**: AddæŒ‰é’®ç‚¹å‡»10ç§’è¶…æ—¶  
**å½±å“**: å¯èƒ½æ˜¯æ­£å¸¸æ“ä½œä½†è¶…æ—¶åˆ¤å®š  
**ä¿®å¤**: å¢åŠ åˆ°20ç§’æˆ–æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´

### ä¼˜å…ˆçº§P3: é”™è¯¯æç¤ºæ•è·

**é—®é¢˜**: æ— æ³•æ•è·åç«¯è¿”å›çš„é”™è¯¯ä¿¡æ¯  
**å½±å“**: æ— æ³•è¯Šæ–­å…·ä½“å¤±è´¥åŸå›   
**ä¿®å¤**: æ·»åŠ é”™è¯¯å…ƒç´ æ£€æµ‹å’Œæ—¥å¿—

---

## âœ… æµ‹è¯•ç»“è®º

### å½“å‰çŠ¶æ€
- â­ï¸ **ä¸¤ä¸ªæµ‹è¯•å‡è·³è¿‡**ï¼ˆåˆç†çš„è·³è¿‡ï¼ŒéBugï¼‰
- âœ… æµ‹è¯•ä»£ç é€»è¾‘å¥å£®
- âš ï¸ ç¼ºå°‘å¿…è¦çš„æµ‹è¯•æ•°æ®

### å»ºè®®
1. **çŸ­æœŸ**ï¼šæ¥å—å½“å‰çŠ¶æ€ï¼Œåœ¨æ–‡æ¡£ä¸­è¯´æ˜å‰ç½®æ¡ä»¶
2. **ä¸­æœŸ**ï¼šé€šè¿‡æ‰‹åŠ¨æˆ–APIå‡†å¤‡æµ‹è¯•æ•°æ®
3. **é•¿æœŸ**ï¼šå®ç°è‡ªåŠ¨åŒ–æµ‹è¯•æ•°æ®å‡†å¤‡

### ä¼˜å…ˆçº§
- ğŸ”´ **ä¸é˜»å¡å‘å¸ƒ** - æ ¸å¿ƒåŠŸèƒ½å·²éªŒè¯
- ğŸŸ¡ **å¯æŒç»­æ”¹è¿›** - å®Œå–„æµ‹è¯•è¦†ç›–
- ğŸŸ¢ **å¢å¼ºå¥å£®æ€§** - è‡ªåŠ¨åŒ–æ•°æ®å‡†å¤‡

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-10-28 16:12  
**æµ‹è¯•æ‰§è¡Œè€…**: HyperEcho  
**ä¸‹æ¬¡å®¡æŸ¥**: æœ‰æ–°æµ‹è¯•æ•°æ®åé‡æ–°éªŒè¯

